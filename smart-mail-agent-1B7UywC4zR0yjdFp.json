{"createdAt":"2025-08-13T10:07:02.289Z","updatedAt":"2025-08-22T15:16:47.000Z","id":"1B7UywC4zR0yjdFp","name":"Smart Mail Agent","active":false,"isArchived":false,"nodes":[{"parameters":{"content":"ğŸ“§ **EMAIL VALIDATION FIX**\n\n**PROBLÃ‰M:**\nâŒ NÄ›kterÃ© firmy majÃ­ email \"N/A\"\nâŒ Workflow padal na chybÄ›jÃ­cÃ­ch emailech\nâŒ Zastavoval celÃ½ proces\n\n**Å˜EÅ ENÃ:**\nâœ… Graceful handling - pÅ™eskoÄÃ­ neplatnÃ© emaily\nâœ… Filter Valid Emails - pouze platnÃ© emaily jdou dÃ¡l\nâœ… LogovÃ¡nÃ­ - vÃ­me, kterÃ© firmy byly pÅ™eskoÄeny\n\n**CO SE DÄšJE:**\nâ€¢ Parse AI Response: oznaÄÃ­ neplatnÃ© emaily jako skip: true\nâ€¢ Filter Valid Emails: pÅ™eskoÄÃ­ poloÅ¾ky s skip: true\nâ€¢ Send Email: zpracuje pouze platnÃ© emaily\nâ€¢ Workflow pokraÄuje bez pÅ™eruÅ¡enÃ­\n\n**VÃSLEDEK:**\nâ€¢ Å½Ã¡dnÃ© chyby pÅ™i neplatnÃ½ch emailech\nâ€¢ Workflow bÄ›Å¾Ã­ plynule\nâ€¢ SledovÃ¡nÃ­ pÅ™eskoÄenÃ½ch firem","height":320,"width":350},"id":"c6320802-e89f-4a72-9d88-a672c5a39e70","name":"ğŸ“§ Email Validation Fix","type":"n8n-nodes-base.stickyNote","position":[-3072,-1840],"typeVersion":1},{"parameters":{"content":"âš¡ **OPTIMALIZACE AI RATING**\n\n**PÅ˜ED:**\nâŒ 200+ Å™Ã¡dkÅ¯ promptu\nâŒ SloÅ¾itÃ© analÃ½zy\nâŒ PomalÃ© zpracovÃ¡nÃ­\nâŒ VysokÃ© token nÃ¡klady\n\n**PO:**\nâœ… 20 Å™Ã¡dkÅ¯ promptu\nâœ… RychlÃ© kritÃ©ria\nâœ… OptimalizovanÃ© zpracovÃ¡nÃ­\nâœ… NiÅ¾Å¡Ã­ nÃ¡klady\n\n**ÃšSPORY:**\nâ€¢ ~80% mÃ©nÄ› tokenÅ¯\nâ€¢ ~3x rychlejÅ¡Ã­ zpracovÃ¡nÃ­\nâ€¢ StejnÃ¡ kvalita hodnocenÃ­\nâ€¢ NiÅ¾Å¡Ã­ API nÃ¡klady\n\n**ZACHOVÃNO:**\nâ€¢ Rating 0-5 systÃ©m\nâ€¢ ÄŒeskÃ© vysvÄ›tlenÃ­\nâ€¢ Marketing potential\nâ€¢ Email template logic","height":300,"width":350},"id":"7b429768-4dd0-421a-9af1-bbea0962f6d1","name":"âš¡ AI Optimization","type":"n8n-nodes-base.stickyNote","position":[-3504,-1648],"typeVersion":1},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","typeVersion":1,"position":[-1312,-736],"id":"c2a64a83-85db-42c3-848f-120879b393da","name":"DeepSeek Chat Model1","credentials":{"deepSeekApi":{"id":"XQXgm6mCKAHVpU2G","name":"DeepSeek account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","typeVersion":1,"position":[-2480,-704],"id":"dcf093ea-1a7c-49b4-8a9f-189bc2efe862","name":"DeepSeek Chat Model","credentials":{"deepSeekApi":{"id":"XQXgm6mCKAHVpU2G","name":"DeepSeek account"}}},{"parameters":{"content":"ğŸ›ï¸ **CENTRALIZOVANÃ KONFIGURACE**\n\n**JEDINÃ ZDROJ PRAVDY:**\nâœ… Master Configuration node obsahuje VÅ E\nâœ… Å½Ã¡dnÃ© duplicitnÃ­ nastavenÃ­\nâœ… SnadnÃ¡ ÃºdrÅ¾ba a zmÄ›ny\n\n**CO OBSAHUJE:**\nâ€¢ Workflow nastavenÃ­ (test_mode, batch_size, wait_time)\nâ€¢ KontaktnÃ­ Ãºdaje (email, telefon, jmÃ©no)\nâ€¢ Service type a rating threshold\n\n**CO ZÅ®STÃVÃ V NODES:**\nâ€¢ Google Sheets ID - v Read/Update nodes\nâ€¢ Gmail credentials - v Send Email node\nâ€¢ Sheets credentials - v Google Sheets nodes\n\n**VÃHODY:**\nâ€¢ Jedno mÃ­sto pro business logic\nâ€¢ Credentials na sprÃ¡vnÃ½ch mÃ­stech\nâ€¢ SnadnÃ© pÅ™epÃ­nÃ¡nÃ­ mezi test/produkce\nâ€¢ Å½Ã¡dnÃ© zapomenutÃ© nastavenÃ­\n\n**PÅ˜ÃKLAD ZMÄšNY:**\nChceÅ¡ zmÄ›nit email? â†’ Uprav Master Configuration â†’ Hotovo!","height":360,"width":350},"id":"dd7d0533-b0d0-432c-8e3e-7355a9de8abb","name":"ğŸ›ï¸ Centralized Config","type":"n8n-nodes-base.stickyNote","position":[-3088,352],"typeVersion":1},{"parameters":{"content":"ğŸ¯ **CENTRALIZOVANÃ‰ KONTAKTNÃ ÃšDAJE**\n\n**JEDINÃ ZDROJ PRAVDY:**\nâœ… Company Setup node obsahuje vÅ¡echny kontaktnÃ­ Ãºdaje\nâœ… Gmail node automaticky pouÅ¾Ã­vÃ¡ tyto Ãºdaje\nâœ… Å½Ã¡dnÃ© duplicitnÃ­ nastavenÃ­\n\n**CO SE POUÅ½ÃVÃ:**\nâ€¢ sender_name: 'Andreas BrudovskÃ½'\nâ€¢ email_address: 'andrasbrudovskyy@gmail.com'\nâ€¢ phone_number: '+420 735 913 637'\nâ€¢ company_name: 'Andreas BrudovskÃ½'\n\n**VÃHODY:**\nâ€¢ Jedno mÃ­sto pro zmÄ›ny\nâ€¢ KonzistentnÃ­ Ãºdaje\nâ€¢ SnadnÃ¡ ÃºdrÅ¾ba\nâ€¢ Å½Ã¡dnÃ© konflikty","height":280,"width":350},"id":"78040113-fdd7-47dd-ac45-fcb97ca76ee6","name":"ğŸ¯ Centralized Contacts","type":"n8n-nodes-base.stickyNote","position":[-3088,144],"typeVersion":1},{"parameters":{"content":"ğŸ“§ **EMAIL STATUS FILTER**\n\n**NovÃ½ filtr:** Filter Not Sent Emails\n\n**Funkce:**\nâ€¢ Kontroluje sloupec 'Status' v Google Sheets\nâ€¢ PÅ™eskoÄÃ­ firmy s Status = 'sent'\nâ€¢ Zpracuje pouze novÃ©/neodeslanÃ© emaily\n\n**VÃ½hody:**\nâ€¢ Å½Ã¡dnÃ© duplikÃ¡tnÃ­ emaily\nâ€¢ BezpeÄnÃ© opakovanÃ© spouÅ¡tÄ›nÃ­\nâ€¢ SledovÃ¡nÃ­ pokroku\n\n**Status hodnoty:**\nâ€¢ 'sent' = email jiÅ¾ odeslÃ¡n\nâ€¢ prÃ¡zdnÃ©/null = email jeÅ¡tÄ› neodeslÃ¡n","height":240,"width":350},"id":"019d458a-250d-4478-bf08-7961ac143215","name":"ğŸ“§ Email Status Filter","type":"n8n-nodes-base.stickyNote","position":[-3936,-1360],"typeVersion":1},{"parameters":{"content":"ğŸ”§ **DUPLIKÃTNÃ EMAILY - OPRAVENO**\n\n**ProblÃ©m vyÅ™eÅ¡en:**\nâœ… Company Setup â†’ Code node s runOnceForEachItem\nâœ… Generate Email pouÅ¾Ã­vÃ¡ .item.json\nâœ… Parse AI Response sprÃ¡vnÃ¡ data\n\n**VÃ½sledek:**\nâ€¢ Å½Ã¡dnÃ© duplikÃ¡tnÃ­ emaily\nâ€¢ KaÅ¾dÃ¡ firma dostane unikÃ¡tnÃ­ email\nâ€¢ SprÃ¡vnÃ© business data pro kaÅ¾dou firmu","height":200,"width":350},"id":"53a92b08-0789-4e9c-85e8-a0d7f47afb2f","name":"ğŸ”§ Fixed Duplicates","type":"n8n-nodes-base.stickyNote","position":[-3072,-1376],"typeVersion":1},{"parameters":{"content":"âš¡ **INTELLIGENT CHUNKING**\n\n**ProblÃ©m vyÅ™eÅ¡en:**\nâœ… AI token limits - max 15 firem na call\nâœ… Rate limiting - inteligentnÃ­ dÃ¡vkovÃ¡nÃ­\nâœ… API nÃ¡klady - optimalizovanÃ© batch size\n\n**Jak to funguje:**\nâ€¢ Chunk Businesses (15 per batch)\nâ€¢ Batch AI Business Rating\nâ€¢ Parse Batch AI Ratings\nâ€¢ Loop zpÄ›t pro dalÅ¡Ã­ chunk\n\n**VÃ½hody:**\nâ€¢ Å½Ã¡dnÃ© AI token limit chyby\nâ€¢ OptimalizovanÃ© API calls\nâ€¢ SpolehlivÃ© zpracovÃ¡nÃ­ stovek firem","height":280,"width":350},"id":"fb02a203-aa79-4ac9-9ba4-3cd10088f76e","name":"âš¡ Intelligent Chunking","type":"n8n-nodes-base.stickyNote","position":[-2640,-1808],"typeVersion":1},{"parameters":{"jsonSchemaExample":"{\n  \"ratings\": [\n    {\n      \"business_name\": \"Autoservis Praha\",\n      \"rating\": 4,\n      \"reasoning\": \"LokÃ¡lnÃ­ autoservis pouze se zÃ¡kladnÃ­ Facebook strÃ¡nkou - vysokÃ½ potenciÃ¡l pro profesionÃ¡lnÃ­ sluÅ¾by\",\n      \"marketing_potential\": \"high\",\n      \"recommended_services\": [\"profesionÃ¡lnÃ­ sluÅ¾by\", \"konzultace\", \"implementace\"],\n      \"industry_insights\": \"AutomobilovÃ½ prÅ¯mysl v ÄŒR roste, online pÅ™Ã­tomnost je klÃ­ÄovÃ¡ pro zÃ­skÃ¡nÃ­ zÃ¡kaznÃ­kÅ¯\",\n      \"competitive_advantage\": \"Online objednÃ¡vky, fotogalerie pracÃ­, recenze zÃ¡kaznÃ­kÅ¯\"\n    },\n    {\n      \"business_name\": \"Restaurace U ZlatÃ© rybky\",\n      \"rating\": 3,\n      \"reasoning\": \"Restaurace s nÄ›jakÃ½mi sluÅ¾bami, ale s prostorem pro zlepÅ¡enÃ­\",\n      \"marketing_potential\": \"medium\",\n      \"recommended_services\": [\"optimalizace\", \"vylepÅ¡enÃ­\"],\n      \"industry_insights\": \"GastronomickÃ½ sektor v ÄŒR je konkurenÄnÃ­, online objednÃ¡vky jsou standardem\",\n      \"competitive_advantage\": \"Online menu, rezervace stolÅ¯, doruÄovÃ¡nÃ­\"\n    }\n  ]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[-2192,-736],"id":"b49fc789-6e56-45c2-bf6a-1e797e2e8b87","name":"Structured Output Parser1"},{"parameters":{"jsCode":"// Generate summary report of the email campaign\nconst allItems = $input.all();\n\nlet totalProcessed = 0;\nlet totalEmailsSent = 0;\nlet highPriorityCount = 0;\nlet mediumPriorityCount = 0;\nlet lowPriorityCount = 0;\nlet errors = [];\n\nfor (const item of allItems) {\n  totalProcessed++;\n  \n  if (item.json.success) {\n    totalEmailsSent++;\n    \n    switch(item.json.priority) {\n      case 'high':\n        highPriorityCount++;\n        break;\n      case 'medium':\n        mediumPriorityCount++;\n        break;\n      case 'low':\n        lowPriorityCount++;\n        break;\n    }\n  } else {\n    errors.push(item.json.error || 'Unknown error');\n  }\n}\n\nconst report = {\n  timestamp: new Date().toISOString(),\n  total_processed: totalProcessed,\n  emails_sent: totalEmailsSent,\n  success_rate: totalProcessed > 0 ? ((totalEmailsSent / totalProcessed) * 100).toFixed(2) + '%' : '0%',\n  priority_breakdown: {\n    high: highPriorityCount,\n    medium: mediumPriorityCount,\n    low: lowPriorityCount\n  },\n  errors: errors,\n  test_mode: $('Master Configuration').first().json.test_mode\n};\n\nreturn report;"},"id":"ead8ffb0-fb83-480b-b9b3-e658c8801ef8","name":"Generate Summary Report","type":"n8n-nodes-base.code","position":[-1392,-1168],"typeVersion":2},{"parameters":{"amount":"={{ $('Master Configuration').first().json.wait_time }}","unit":"seconds"},"id":"20e93929-9eef-4392-90db-b4f9b65dddca","name":"Wait Between Emails","type":"n8n-nodes-base.wait","position":[-80,-976],"typeVersion":1,"webhookId":"caa4c0a7-1ddc-4dbb-8de0-16d3925441bd"},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs","mode":"list","cachedResultName":"n8n firmyCZ scrape","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"List 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"Business Name":"={{ $('Parse AI Response').item.json.business_data.company_name }}","Status":"sent"},"matchingColumns":["Business Name"],"schema":[{"id":"Business Name","displayName":"Business Name","required":false,"defaultMatch":true,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Status","displayName":"Status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"id":"a5810bfc-d4ed-4d3b-82b5-51599f736f5d","name":"Update Google Sheet Status","type":"n8n-nodes-base.googleSheets","position":[-272,-976],"typeVersion":4.6,"credentials":{"googleSheetsOAuth2Api":{"id":"Zx6E2WZ3T6x3R24f","name":"Google Sheets account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"skip-check","operator":{"type":"boolean","operation":"notEquals"},"leftValue":"={{ $json.skip }}","rightValue":true}],"combinator":"and"},"options":{}},"id":"b387a7b8-e6cb-47aa-a133-b765aff53b82","name":"Filter Valid Emails","type":"n8n-nodes-base.filter","position":[-688,-976],"typeVersion":2.2},{"parameters":{"sendTo":"={{ $json.to }}","subject":"={{ $json.subject }}","emailType":"text","message":"={{ $json.body }}","options":{"appendAttribution":false,"senderName":"={{ $('Master Configuration').first().json.sender_name }}","replyTo":"={{ $('Master Configuration').first().json.email_address }}"}},"id":"6647507d-1bc6-4856-98df-277e3fb8e521","name":"Send Email","type":"n8n-nodes-base.gmail","position":[-496,-976],"typeVersion":2.1,"webhookId":"763bbad5-2836-4875-ae49-d372af3bb720","credentials":{"gmailOAuth2":{"id":"3M0CLo4vVbFsJnGB","name":"andreasbrudovskyy@gmail acc"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Parse AI response and prepare for email sending\nconst aiResponse = $input.item.json.output;\nconst businessData = $('Prepare AI Data').item.json.business_data;\nconst testMode = $('Master Configuration').first().json.test_mode;\nconst testEmail = $('Master Configuration').first().json.test_email;\n\n// Determine recipient email\nlet recipientEmail = businessData.email;\nlet subjectPrefix = '';\n\nif (testMode) {\n  recipientEmail = testEmail;\n  subjectPrefix = '[TEST] ';\n}\n\n// Handle invalid email addresses gracefully\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nif (!recipientEmail || recipientEmail === '' || recipientEmail === 'N/A' || !emailRegex.test(recipientEmail)) {\n  // Skip this business instead of throwing error\n  return {\n    skip: true,\n    reason: `Skipping ${businessData.company_name} - invalid email: ${recipientEmail}`,\n    business_data: businessData\n  };\n}\n\n// Additional validation for production mode\nif (!testMode) {\n  // Skip common invalid emails\n  const invalidEmails = ['info@', 'admin@', 'noreply@', 'test@', 'example@'];\n  const isInvalid = invalidEmails.some(invalid => recipientEmail.toLowerCase().includes(invalid));\n  \n  if (isInvalid) {\n    return {\n      skip: true,\n      reason: `Skipping ${businessData.company_name} - generic email: ${recipientEmail}`,\n      business_data: businessData\n    };\n  }\n}\n\nreturn {\n  to: recipientEmail,\n  subject: subjectPrefix + (aiResponse.subject || 'ProfesionÃ¡lnÃ­ webovÃ© strÃ¡nky'),\n  body: aiResponse.body || 'Email body not generated properly',\n  priority: aiResponse.priority || 'medium',\n  business_data: businessData,\n  test_mode: testMode,\n  skip: false\n};"},"id":"8251e08f-a5e5-4929-9aea-6e154a97fc12","name":"Parse AI Response","type":"n8n-nodes-base.code","position":[-848,-976],"typeVersion":2},{"parameters":{"jsonSchemaExample":"{\n  \"subject\": \"ProfesionÃ¡lnÃ­ webovÃ© strÃ¡nky pro vaÅ¡i spoleÄnost\",\n  \"body\": \"VÃ¡Å¾enÃ½ pane/panÃ­,\\n\\nVÅ¡iml/a jsem si, Å¾e vaÅ¡e spoleÄnost...\",\n  \"priority\": \"high\"\n}"},"id":"9aa2950c-29fa-45fe-9b58-1ffefeaf8775","name":"Structured Output Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","position":[-1040,-704],"typeVersion":1.2},{"parameters":{"promptType":"define","text":"=## BUSINESS DATA\n{{ $('Prepare AI Data').item.json.business_data.toJsonString() }}\n\n## YOUR COMPANY INFO\n{{ $('Master Configuration').first().json.toJsonString() }}\n\n## SERVICE FOCUS\n{{ $('Prepare AI Data').item.json.service_focus }}\n\n## RATING & PRIORITY\nRating: {{ $('Prepare AI Data').item.json.business_data.rating }}/5\nPriority: {{ $('Prepare AI Data').item.json.urgency_level }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"=## ROLE\nJsi expertnÃ­ marketingovÃ½ specialista pro {{ $('Master Configuration').first().json.service_type }} sluÅ¾by v ÄŒeskÃ© republice. TvÃ½m Ãºkolem je vytvoÅ™it personalizovanÃ½ cold email v ÄeÅ¡tinÄ›.\n\n## DÅ®LEÅ½ITÃ‰ PRAVIDLA\n\n**1. KONTAKTNÃ ÃšDAJE - KRITICKÃ‰:**\n- V emailu MUSÃÅ  pouÅ¾Ã­t KONTAKTNÃ ÃšDAJE ODESÃLATELE ({{ $('Master Configuration').first().json.sender_name }}, {{ $('Master Configuration').first().json.email_address }}, {{ $('Master Configuration').first().json.phone_number }})\n- NIKDY nepouÅ¾Ã­vej kontaktnÃ­ Ãºdaje pÅ™Ã­jemce v podpisu\n- Podpis musÃ­ obsahovat: {{ $('Master Configuration').first().json.sender_name }}, {{ $('Master Configuration').first().json.email_address }}, {{ $('Master Configuration').first().json.phone_number }}\n- PÅ™edmÄ›t ponechej jednoduchÃ½, tedy jenom jakÃ¡ sluÅ¾ba je propagovÃ¡na\n\n**2. PERSONALIZACE:**\n- PouÅ¾ij nÃ¡zev firmy: {{ $('Prepare AI Data').item.json.business_data.company_name }}\n- PouÅ¾ij mÄ›sto: {{ $('Prepare AI Data').item.json.business_data.city }}\n- PouÅ¾ij obor: {{ $('Prepare AI Data').item.json.business_data.industry }}\n- PouÅ¾ij rating: {{ $('Prepare AI Data').item.json.business_data.rating }}/5\n- PouÅ¾ij nÃ¡zev tvÃ© firmy: {{ $('Master Configuration').first().json.company_name }}\n\n\n- DÃ¡le vzkaÅ¾ Å¾e napÅ™Ã­klad u webdesignu, by byla nabÃ­dka takovÃ¡, Å¾e se by se firmÄ› prvnÄ› ukÃ¡zal zadarmo nÃ¡vrh webovÃ½ch strÃ¡nek, a pokud by to bylo schvÃ¡leno tak bychom se domluvili na cenÄ›\n\n**4. STRUKTURA EMAILU:**\n1. OslovenÃ­ (VÃ¡Å¾enÃ½ pane/panÃ­)\n2. PersonalizovanÃ½ Ãºvod (zmÃ­nit jejich firmu)\n3. ProblÃ©m (co jim chybÃ­)\n4. Å˜eÅ¡enÃ­ (jak jim pomÅ¯Å¾eme) + jemnÃ© zmÃ­nky o vÃ½hodÃ¡ch\n5. DÃ¡le vzkaÅ¾ Å¾e napÅ™Ã­klad u webdesignu, by byla nabÃ­dka takovÃ¡, Å¾e se by se firmÄ› prvnÄ› ukÃ¡zal zadarmo nÃ¡vrh webovÃ½ch strÃ¡nek, a pokud by to bylo schvÃ¡leno tak bychom se domluvili na cenÄ›\n6. Call to action (konkrÃ©tnÃ­ dalÅ¡Ã­ krok)\n7. Podpis (profesionÃ¡lnÃ­ formÃ¡t s firmou)\n-tohle vÅ¡e zanechej jednoduchÃ©, aÅ¥ to nepÅ¯sobÃ­ jako spam mail\n\n\n**5. RATING-BASED PÅ˜ÃSTUP:**\n- Rating 4-5: \"VytvoÅ™Ã­me profesionÃ¡lnÃ­ {{ $('Master Configuration').first().json.service_type }} Å™eÅ¡enÃ­ od zÃ¡kladÅ¯\"\n- Rating 3: \"VylepÅ¡Ã­me vaÅ¡e souÄasnÃ© {{ $('Master Configuration').first().json.service_type }} moÅ¾nosti\"\n- Rating 1-2: \"Konzultace a analÃ½za {{ $('Master Configuration').first().json.service_type }} moÅ¾nostÃ­\"\n\n**6. DYNAMICKÃ‰ CALL TO ACTION:**\n- Vygeneruj 1-2 relevantnÃ­ call to action pro {{ $('Master Configuration').first().json.service_type }}\n- PouÅ¾ij konkrÃ©tnÃ­ akce: schÅ¯zka, nabÃ­dka, konzultace, demo\n- PÅ™izpÅ¯sob oboru firmy: {{ $('Prepare AI Data').item.json.business_data.industry }}\n- PouÅ¾ij telefon: {{ $('Master Configuration').first().json.phone_number }}\n\n## OUTPUT FORMAT\nVrÃ¡Å¥ JSON objekt:\n{\n  \"subject\": \"[PÅ™edmÄ›t emailu]\",\n  \"body\": \"[TÄ›lo emailu v ÄeÅ¡tinÄ› s tvÃ½mi kontaktnÃ­mi Ãºdaji]\",\n  \"priority\": \"high/medium/low\"\n}\n\n## PROFESIONÃLNÃ PODPIS\nPouÅ¾ij tento formÃ¡t:\n\nS pozdravem,\n{{ $('Master Configuration').first().json.sender_name }} | {{ $('Master Configuration').first().json.company_name }}\n{{ $('Master Configuration').first().json.email_address }}\n{{ $('Master Configuration').first().json.phone_number }}\n\nVytvoÅ™ personalizovanÃ½ email pro firmu {{ $('Prepare AI Data').item.json.business_data.company_name }}."}]},"batching":{}},"id":"18782efe-8e0a-49ca-8584-dc8e00f6cc96","name":"Generate Personalized Email","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[-1280,-976],"typeVersion":1.7},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Prepare data for AI email generation\nconst business = $input.item.json;\n\n// Handle both Google Sheets format and AI rating format\nconst businessData = {\n  company_name: business['Business Name'] || business.business_name || 'Unknown Company',\n  contact_person: business.Contact_Person || business.Owner || 'Business Owner',\n  email: business.Email || business.email || '',\n  phone: business.Phone || business.phone || '',\n  website: business.Website || business.website || '',\n  address: business['Full Address'] || business.address || '',\n  city: business.City || business.city || '',\n  industry: business.Industry || business.industry || '',\n  rating: business.rating || 0,\n  reasoning: business.reasoning || '',\n  marketing_potential: business.marketing_potential || 'medium',\n  recommended_services: business.recommended_services || [],\n  industry_insights: business.industry_insights || '',\n  competitive_advantage: business.competitive_advantage || '',\n  template_type: business.email_template || 'medium_priority'\n};\n\n// Create personalized prompt based on rating\nlet serviceFocus = '';\nlet urgencyLevel = '';\n\nif (businessData.rating >= 4) {\n  serviceFocus = 'professional website development';\n  urgencyLevel = 'high priority';\n} else if (businessData.rating >= 3) {\n  serviceFocus = 'website upgrade and optimization';\n  urgencyLevel = 'medium priority';\n} else {\n  serviceFocus = 'website consultation and improvement';\n  urgencyLevel = 'low priority';\n}\n\nreturn {\n  business_data: businessData,\n  service_focus: serviceFocus,\n  urgency_level: urgencyLevel,\n  template_type: businessData.template_type\n};"},"id":"3e789d09-0c4c-46da-a199-9b2343d54567","name":"Prepare AI Data","type":"n8n-nodes-base.code","position":[-1456,-976],"typeVersion":2},{"parameters":{"batchSize":"={{ $('Master Configuration').first().json.batch_size }}","options":{}},"id":"3a0a652a-ac32-4f3d-a2b1-7d34f788865b","name":"Batch Process","type":"n8n-nodes-base.splitInBatches","position":[-1712,-1008],"typeVersion":3},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"rating-check","operator":{"type":"number","operation":"gte"},"leftValue":"={{ $json.rating }}","rightValue":"={{ $('Master Configuration').first().json.rating_threshold }}"}],"combinator":"and"},"options":{}},"id":"63e8f4a0-193f-4790-b2a9-ab523b6d8c55","name":"Filter High Priority (Rating 3-5)","type":"n8n-nodes-base.filter","position":[-1936,-1024],"typeVersion":2.2},{"parameters":{"jsCode":"// Parse batch AI ratings and return individual business items with ratings\nconst aiResponse = $input.item.json.output;\nconst batchRatings = aiResponse.ratings || [];\nconst allItems = $('Prepare Chunk for AI Rating').all();\n\n// Get the original businesses from the chunk\nconst originalBusinesses = allItems[0].json.businesses;\n\n// Create enriched business items with ratings\nconst enrichedItems = originalBusinesses.map(business => {\n  const businessName = business.business_name || '';\n  \n  // Find matching rating for this business\n  const rating = batchRatings.find(r => r.business_name === businessName);\n  \n  if (!rating) {\n    // Fallback if business not found in ratings\n    return {\n      ...business,\n      rating: 0,\n      reasoning: 'Business not found in AI ratings',\n      marketing_potential: 'low',\n      recommended_services: [],\n      industry_insights: '',\n      competitive_advantage: '',\n      email_template: 'low_priority',\n      ai_rated: true\n    };\n  }\n  \n  // Determine email template based on rating\n  let emailTemplate = 'low_priority';\n  if (rating.rating >= 4) {\n    emailTemplate = 'high_priority';\n  } else if (rating.rating >= 2) {\n    emailTemplate = 'medium_priority';\n  }\n  \n  // Combine business data with AI rating (simplified format)\n  const enrichedData = {\n    ...business,\n    rating: rating.rating,\n    reasoning: rating.reasoning || 'HodnocenÃ­ bez vysvÄ›tlenÃ­',\n    marketing_potential: rating.marketing_potential || 'medium',\n    recommended_services: rating.recommended_services || [],\n    industry_insights: rating.industry_insights || '',\n    competitive_advantage: rating.competitive_advantage || '',\n    email_template: emailTemplate,\n    ai_rated: true\n  };\n  \n  return enrichedData;\n});\n\nreturn enrichedItems;"},"id":"07a65460-c045-4ada-b5d7-b41306c43b74","name":"Parse Batch AI Ratings","type":"n8n-nodes-base.code","position":[-2112,-928],"typeVersion":2},{"parameters":{"promptType":"define","text":"=Businesses Data:\n{{ $('Prepare Chunk for AI Rating').first().json.businesses.toJsonString() }}\n\nService Type: {{ $('Prepare Chunk for AI Rating').first().json.service_type }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"=Jsi AI marketing specialista pro {{ $('Prepare Chunk for AI Rating').first().json.service_type }} sluÅ¾by v ÄŒR. OhodnoÅ¥ kaÅ¾dou firmu 0-5 podle potenciÃ¡lu pro {{ $('Prepare Chunk for AI Rating').first().json.service_type }}.\n\n**KRITÃ‰RIA:**\n5: Å½Ã¡dnÃ© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - vysokÃ½ potenciÃ¡l\n4: ZÃ¡kladnÃ­ {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - potÅ™ebuje vylepÅ¡enÃ­\n3: NÄ›jakÃ© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - prostor pro optimalizaci\n2: DobrÃ© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - omezenÃ½ potenciÃ¡l\n1: VynikajÃ­cÃ­ {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - minimÃ¡lnÃ­ potenciÃ¡l\n0: NevhodnÃ© (velkÃ© firmy, stÃ¡tnÃ­ instituce)\n\n**RYCHLÃ‰ ANALÃZY:**\n- Bez webu = Rating 4-5\n- ZÃ¡kladnÃ­ web = Rating 3-4\n- PokroÄilÃ½ web = Rating 1-2\n- MalÃ© firmy (1-10 zamÄ›stnancÅ¯) = +1 rating\n- VelkÃ© firmy (50+) = -1 rating\n\n**OUTPUT:** JSON s ratings array:\n{\n  \"ratings\": [\n    {\n      \"business_name\": \"NÃ¡zev firmy\",\n      \"rating\": 4,\n      \"reasoning\": \"KrÃ¡tkÃ© vysvÄ›tlenÃ­ v ÄeÅ¡tinÄ›\",\n      \"marketing_potential\": \"high/medium/low\"\n    }\n  ]\n}\n\nAnalyzuj vÅ¡echny firmy a vraÅ¥ hodnocenÃ­."}]},"batching":{}},"id":"89472445-8330-4699-b7ea-1f834b3d2a49","name":"Batch AI Business Rating","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[-2416,-928],"typeVersion":1.7,"retryOnFail":true},{"parameters":{"jsCode":"// Prepare chunk of businesses for AI rating\nconst allItems = $input.all();\nconst serviceType = allItems[0].json.service_type;\n\n// Extract businesses from this chunk\nconst businesses = allItems.map(item => {\n  const business = item.json;\n  return {\n    business_name: business.business_name || '',\n    description: business.description || '',\n    website: business.website || '',\n    all_websites: business.all_websites || '',\n    industry: business.industry || '',\n    city: business.city || '',\n    address: business.address || '',\n    phone: business.phone || '',\n    email: business.email || '',\n    facebook: business.facebook || '',\n    instagram: business.instagram || '',\n    linkedin: business.linkedin || '',\n    twitter: business.twitter || '',\n    youtube: business.youtube || '',\n    opening_hours: business.opening_hours || '',\n    ico: business.ico || ''\n  };\n});\n\nreturn {\n  businesses: businesses,\n  service_type: serviceType,\n  chunk_size: businesses.length,\n  chunk_number: $('Chunk Businesses (15 per batch)').context.currentBatchIndex + 1\n};"},"id":"e3bdcde8-e4cc-4225-b5af-18d4d2e1893d","name":"Prepare Chunk for AI Rating","type":"n8n-nodes-base.code","position":[-2576,-928],"typeVersion":2},{"parameters":{"batchSize":15,"options":{}},"id":"c66a6955-9e84-41f5-ae6e-a85cf4797cf1","name":"Chunk Businesses (15 per batch)","type":"n8n-nodes-base.splitInBatches","position":[-2832,-960],"typeVersion":3},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Prepare individual business for processing\nconst business = $input.item.json;\nconst serviceType = $('Master Configuration').first().json.service_type;\n\n// Prepare business data\nreturn {\n  business_name: business['Business Name'] || '',\n  description: business.Description || '',\n  website: business.Website || '',\n  all_websites: business['All Websites'] || '',\n  industry: business.Industry || '',\n  city: business.City || '',\n  address: business['Full Address'] || '',\n  phone: business.Phone || '',\n  email: business.Email || '',\n  facebook: business.Facebook || '',\n  instagram: business.Instagram || '',\n  linkedin: business.LinkedIn || '',\n  twitter: business.Twitter || '',\n  youtube: business.YouTube || '',\n  opening_hours: business['Opening Hours'] || '',\n  ico: business.ICO || '',\n  // Keep original data for later use\n  original_data: business,\n  service_type: serviceType\n};"},"id":"137bf5d0-c9d0-4d15-88f5-027333765167","name":"Batch Prepare Business Data","type":"n8n-nodes-base.code","position":[-3040,-960],"typeVersion":2},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"email-check","operator":{"type":"string","operation":"exists"},"leftValue":"={{ $json.Email }}","rightValue":""},{"id":"business-name-check","operator":{"type":"string","operation":"exists"},"leftValue":"={{ $json['Business Name'] }}","rightValue":""},{"id":"6d9919c9-38b9-47dc-b98b-7221fabf82c6","leftValue":"={{ $json.Status }}","rightValue":"sent","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"id":"5a7556a0-0abf-4274-a79f-f29c926a419c","name":"Filter Valid Businesses","type":"n8n-nodes-base.filter","position":[-3232,-960],"typeVersion":2.2},{"parameters":{"documentId":{"__rl":true,"value":"1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs","mode":"list","cachedResultName":"n8n firmyCZ scrape","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"List 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1-r_o5J2st9R4GVzHELLKnGh8N12cM-BAhIBK54GNbcs/edit#gid=0"},"options":{}},"id":"f823f01b-345c-4fad-ac33-740c31467157","name":"Read Google Sheet","type":"n8n-nodes-base.googleSheets","position":[-3424,-960],"typeVersion":4.6,"credentials":{"googleSheetsOAuth2Api":{"id":"Zx6E2WZ3T6x3R24f","name":"Google Sheets account"}}},{"parameters":{"assignments":{"assignments":[{"id":"service-type","name":"service_type","type":"string","value":"webdesign"},{"id":"test-mode","name":"test_mode","type":"boolean","value":true},{"id":"test-email","name":"test_email","type":"string","value":"andreas.ab@seznam.cz"},{"id":"batch-size","name":"batch_size","type":"number","value":5},{"id":"wait-time","name":"wait_time","type":"number","value":5},{"id":"rating-threshold","name":"rating_threshold","type":"number","value":4},{"id":"company-name","name":"company_name","type":"string","value":"rec solutions"},{"id":"email-address","name":"email_address","type":"string","value":"andrasbrudovskyy@gmail.com"},{"id":"phone-number","name":"phone_number","type":"string","value":"+420 735 913 637"},{"id":"sender-name","name":"sender_name","type":"string","value":"Andreas BrudovskÃ½"}]},"options":{}},"id":"bca2d5c4-3225-4fe2-a238-a7c3fe8648db","name":"Master Configuration","type":"n8n-nodes-base.set","position":[-3616,-960],"typeVersion":3.4},{"parameters":{},"id":"8cc6a070-986f-4dc6-a7eb-bc1c17eb525a","name":"Manual Trigger","type":"n8n-nodes-base.manualTrigger","position":[-3840,-960],"typeVersion":1},{"parameters":{"content":"ğŸš¨ **PRODUKÄŒNÃ KONTROLNÃ SEZNAM**\n\n**PÅ˜ED PÅ˜EPNUTÃM NA PRODUKCI:**\n\n1. âœ… **KontaktnÃ­ Ãºdaje**\n   â€¢ Zkontroluj Company Setup node\n   â€¢ SkuteÄnÃ½ nÃ¡zev firmy\n   â€¢ SkuteÄnÃ½ email a telefon\n   â€¢ SkuteÄnÃ© jmÃ©no odesÃ­latele\n\n2. âœ… **Test reÅ¾im**\n   â€¢ Service Configuration: test_mode = false\n   â€¢ Otestuj s malÃ½m poÄtem firem\n   â€¢ Zkontroluj prvnÃ­ emaily\n\n3. âœ… **API limity**\n   â€¢ Gmail: max 500 emailÅ¯/den\n   â€¢ OpenAI: dostatek kreditu\n   â€¢ Google Sheets: oprÃ¡vnÄ›nÃ­\n\n4. âœ… **BezpeÄnost**\n   â€¢ Å½Ã¡dnÃ© placeholder Ãºdaje\n   â€¢ Validace emailÅ¯ aktivnÃ­\n   â€¢ Rate limiting nastaven\n\n**âš ï¸ VAROVÃNÃ:**\nâ€¢ Emaily se odeÅ¡lou na skuteÄnÃ© adresy\nâ€¢ Nelze vrÃ¡tit zpÄ›t\nâ€¢ Sleduj bounce rate","height":400,"width":400},"id":"f0b3f784-30d4-4e09-bc9d-dd33af67eddd","name":"ğŸš¨ Production Checklist","type":"n8n-nodes-base.stickyNote","position":[-3936,144],"typeVersion":1},{"parameters":{"content":"ğŸ¯ **CUSTOMIZATION**\n\n**AI Prompts:**\nâ€¢ AI Business Rating - kritÃ©ria hodnocenÃ­\nâ€¢ Generate Email - styl emailÅ¯\nâ€¢ Rating threshold - minimÃ¡lnÃ­ rating\n\n**Email Templates:**\nâ€¢ Å ablony podle ratingu\nâ€¢ Company Setup Ãºdaje\nâ€¢ Personalizace promÄ›nnÃ½ch\n\n**Business Logic:**\nâ€¢ Rating criteria\nâ€¢ FiltrovÃ¡nÃ­\nâ€¢ DalÅ¡Ã­ sluÅ¾by\n\n**Safety:**\nâ€¢ VÅ¾dy testuj s test_mode=true\nâ€¢ Sleduj API limity","height":300,"width":320},"id":"c79f6ac2-593b-431a-9c4c-8069c2fd9e01","name":"ğŸ¯ Customization","type":"n8n-nodes-base.stickyNote","position":[-3280,0],"typeVersion":1},{"parameters":{"content":"ğŸ“Š **PERFORMANCE**\n\n**Optimalizace:**\nâ€¢ Batch size: 5-10 firem\nâ€¢ Wait time: 30s mezi emaily\nâ€¢ ~100-200 firem za hodinu\n\n**Limity:**\nâ€¢ Gmail: 500 emailÅ¯/den\nâ€¢ OpenAI: zÃ¡leÅ¾Ã­ na kreditu\nâ€¢ Google Sheets: 100 requests/100s\n\n**Monitoring:**\nâ€¢ Sleduj OpenAI API kredit\nâ€¢ Kontroluj bounce rate\nâ€¢ ZÃ¡lohuj data pravidelnÄ›","height":280,"width":300},"id":"db9432fe-f710-40b0-b856-cd304b184c6d","name":"ğŸ“Š Performance","type":"n8n-nodes-base.stickyNote","position":[-2400,-496],"typeVersion":1},{"parameters":{"content":"ğŸ”§ **TROUBLESHOOTING**\n\n**Emaily se neodesÃ­lajÃ­:**\nâ€¢ Zkontroluj Gmail credentials\nâ€¢ OvÄ›Å™ nastavenÃ­ odesÃ­latele\n\n**AI nefunguje:**\nâ€¢ Zkontroluj OpenAI API credentials\nâ€¢ OvÄ›Å™ API kredit\n\n**Google Sheets se neaktualizuje:**\nâ€¢ Zkontroluj Google Sheets credentials\nâ€¢ OvÄ›Å™ oprÃ¡vnÄ›nÃ­ k tabulce\n\n**Workflow se zastavÃ­:**\nâ€¢ Zkontroluj, Å¾e Code nodes majÃ­:\n  mode: 'runOnceForEachItem'","height":320,"width":320},"id":"9aad1947-81b8-429e-acee-e5baeb49df86","name":"ğŸ”§ Troubleshooting","type":"n8n-nodes-base.stickyNote","position":[-2800,-496],"typeVersion":1},{"parameters":{"content":"ğŸ”„ **WORKFLOW FLOW**\n\n**1. SpuÅ¡tÄ›nÃ­** â†’ Manual Trigger\n**2. Konfigurace** â†’ Service Configuration\n**3. Data** â†’ Read Google Sheet\n**4. FiltrovÃ¡nÃ­** â†’ Filter Valid Businesses\n**5. AI Rating** â†’ Batch AI Business Rating\n**6. Priorita** â†’ Filter High Priority (3-5)\n**7. DÃ¡vkovÃ¡nÃ­** â†’ Batch Process\n**8. Emaily** â†’ Generate â†’ Send â†’ Update\n**9. ÄŒekÃ¡nÃ­** â†’ Wait Between Emails\n**10. Loop** â†’ ZpÄ›t na dalÅ¡Ã­ firmu","height":300,"width":350},"id":"749fe85e-0fbb-4a14-bdf5-44bfd21043ec","name":"ğŸ”„ Workflow Flow","type":"n8n-nodes-base.stickyNote","position":[-3296,-480],"typeVersion":1},{"parameters":{"content":"ğŸ”‘ **CREDENTIALS**\n\n**PotÅ™ebnÃ© API klÃ­Äe:**\nâ€¢ Google Sheets OAuth2 - ÄtenÃ­/aktualizace\nâ€¢ Gmail OAuth2 - odesÃ­lÃ¡nÃ­ emailÅ¯\nâ€¢ OpenAI API - AI hodnocenÃ­ a generovÃ¡nÃ­\n\n**TEST MODE:**\nâ€¢ test_mode: true â†’ emaily na test_email\nâ€¢ test_mode: false â†’ emaily na skuteÄnÃ© adresy\n\n**âš ï¸ DÅ®LEÅ½ITÃ‰:**\nâ€¢ Zkontroluj OpenAI API kredit\nâ€¢ OvÄ›Å™ oprÃ¡vnÄ›nÃ­ k Google Sheets","height":280,"width":350},"id":"0c4b4f83-b3e4-4097-9400-79cdf6d41851","name":"ğŸ”‘ Credentials","type":"n8n-nodes-base.stickyNote","position":[-3920,-16],"typeVersion":1},{"parameters":{"content":"ğŸš€ **SMART MAIL AGENT**\n\n**ÃšÄŒEL:** AutomatickÃ© hodnocenÃ­ firem a odesÃ­lÃ¡nÃ­ personalizovanÃ½ch emailÅ¯\n\n**RYCHLÃ START:**\n1. âœ… Zkontroluj credentials (Google Sheets, Gmail, OpenAI)\n2. âœ… Nastav test_mode=true pro testovÃ¡nÃ­\n3. âœ… Uprav Company Setup s tvÃ½mi Ãºdaji\n4. âœ… SpusÅ¥ workflow\n\n**KLÃÄŒOVÃ NASTAVENÃ:**\nâ€¢ test_mode: true/false\nâ€¢ batch_size: 5-10 firem\nâ€¢ wait_time: 30s mezi emaily\nâ€¢ rating_threshold: 3 (minimÃ¡lnÃ­ rating)\n\n**BEZPEÄŒNOST:**\nâš ï¸ VÅ¾dy testuj pÅ™ed produkÄnÃ­m spuÅ¡tÄ›nÃ­m\nâš ï¸ Sleduj OpenAI API kredit","height":320,"width":400},"id":"4c23118d-f4e4-4661-91cc-032b4bea0093","name":"ğŸ“‹ Quick Start Guide","type":"n8n-nodes-base.stickyNote","position":[-3936,-496],"typeVersion":1}],"connections":{"Wait Between Emails":{"main":[[{"node":"Batch Process","type":"main","index":0}]]},"Update Google Sheet Status":{"main":[[{"node":"Wait Between Emails","type":"main","index":0}]]},"Filter Valid Emails":{"main":[[{"node":"Send Email","type":"main","index":0}]]},"Send Email":{"main":[[{"node":"Update Google Sheet Status","type":"main","index":0}]]},"Parse AI Response":{"main":[[{"node":"Filter Valid Emails","type":"main","index":0}]]},"DeepSeek Chat Model1":{"ai_languageModel":[[{"node":"Generate Personalized Email","type":"ai_languageModel","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Generate Personalized Email","type":"ai_outputParser","index":0}]]},"Generate Personalized Email":{"main":[[{"node":"Parse AI Response","type":"main","index":0}]]},"Prepare AI Data":{"main":[[{"node":"Generate Personalized Email","type":"main","index":0}]]},"Batch Process":{"main":[[{"node":"Generate Summary Report","type":"main","index":0}],[{"node":"Prepare AI Data","type":"main","index":0}]]},"Filter High Priority (Rating 3-5)":{"main":[[{"node":"Batch Process","type":"main","index":0}]]},"Parse Batch AI Ratings":{"main":[[{"node":"Chunk Businesses (15 per batch)","type":"main","index":0}]]},"DeepSeek Chat Model":{"ai_languageModel":[[{"node":"Batch AI Business Rating","type":"ai_languageModel","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"Batch AI Business Rating","type":"ai_outputParser","index":0}]]},"Batch AI Business Rating":{"main":[[{"node":"Parse Batch AI Ratings","type":"main","index":0}]]},"Prepare Chunk for AI Rating":{"main":[[{"node":"Batch AI Business Rating","type":"main","index":0}]]},"Chunk Businesses (15 per batch)":{"main":[[{"node":"Filter High Priority (Rating 3-5)","type":"main","index":0}],[{"node":"Prepare Chunk for AI Rating","type":"main","index":0}]]},"Batch Prepare Business Data":{"main":[[{"node":"Chunk Businesses (15 per batch)","type":"main","index":0}]]},"Filter Valid Businesses":{"main":[[{"node":"Batch Prepare Business Data","type":"main","index":0}]]},"Read Google Sheet":{"main":[[{"node":"Filter Valid Businesses","type":"main","index":0}]]},"Master Configuration":{"main":[[{"node":"Read Google Sheet","type":"main","index":0}]]},"Manual Trigger":{"main":[[{"node":"Master Configuration","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"ed3a4c20-f89c-4da5-98fa-3832730a27e3","triggerCount":0,"shared":[{"createdAt":"2025-08-13T10:07:02.294Z","updatedAt":"2025-08-13T10:07:02.294Z","role":"workflow:owner","workflowId":"1B7UywC4zR0yjdFp","projectId":"zpk8zHoHWXf3cQ7T"}],"tags":[]}