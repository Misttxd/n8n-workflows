{"createdAt":"2025-08-13T10:07:02.289Z","updatedAt":"2025-08-29T10:04:17.000Z","id":"1B7UywC4zR0yjdFp","name":"Smart Mail Agent","active":false,"isArchived":false,"nodes":[{"parameters":{"content":"üìß **EMAIL VALIDATION FIX**\n\n**PROBL√âM:**\n‚ùå Nƒõkter√© firmy maj√≠ email \"N/A\"\n‚ùå Workflow padal na chybƒõj√≠c√≠ch emailech\n‚ùå Zastavoval cel√Ω proces\n\n**≈òE≈†EN√ç:**\n‚úÖ Graceful handling - p≈ôeskoƒç√≠ neplatn√© emaily\n‚úÖ Filter Valid Emails - pouze platn√© emaily jdou d√°l\n‚úÖ Logov√°n√≠ - v√≠me, kter√© firmy byly p≈ôeskoƒçeny\n\n**CO SE DƒöJE:**\n‚Ä¢ Parse AI Response: oznaƒç√≠ neplatn√© emaily jako skip: true\n‚Ä¢ Filter Valid Emails: p≈ôeskoƒç√≠ polo≈æky s skip: true\n‚Ä¢ Send Email: zpracuje pouze platn√© emaily\n‚Ä¢ Workflow pokraƒçuje bez p≈ôeru≈°en√≠\n\n**V√ùSLEDEK:**\n‚Ä¢ ≈Ω√°dn√© chyby p≈ôi neplatn√Ωch emailech\n‚Ä¢ Workflow bƒõ≈æ√≠ plynule\n‚Ä¢ Sledov√°n√≠ p≈ôeskoƒçen√Ωch firem","height":320,"width":350},"id":"c6320802-e89f-4a72-9d88-a672c5a39e70","name":"üìß Email Validation Fix","type":"n8n-nodes-base.stickyNote","position":[-3072,-1840],"typeVersion":1},{"parameters":{"content":"‚ö° **OPTIMALIZACE AI RATING**\n\n**P≈òED:**\n‚ùå 200+ ≈ô√°dk≈Ø promptu\n‚ùå Slo≈æit√© anal√Ωzy\n‚ùå Pomal√© zpracov√°n√≠\n‚ùå Vysok√© token n√°klady\n\n**PO:**\n‚úÖ 20 ≈ô√°dk≈Ø promptu\n‚úÖ Rychl√© krit√©ria\n‚úÖ Optimalizovan√© zpracov√°n√≠\n‚úÖ Ni≈æ≈°√≠ n√°klady\n\n**√öSPORY:**\n‚Ä¢ ~80% m√©nƒõ token≈Ø\n‚Ä¢ ~3x rychlej≈°√≠ zpracov√°n√≠\n‚Ä¢ Stejn√° kvalita hodnocen√≠\n‚Ä¢ Ni≈æ≈°√≠ API n√°klady\n\n**ZACHOV√ÅNO:**\n‚Ä¢ Rating 0-5 syst√©m\n‚Ä¢ ƒåesk√© vysvƒõtlen√≠\n‚Ä¢ Marketing potential\n‚Ä¢ Email template logic","height":300,"width":350},"id":"7b429768-4dd0-421a-9af1-bbea0962f6d1","name":"‚ö° AI Optimization","type":"n8n-nodes-base.stickyNote","position":[-3504,-1648],"typeVersion":1},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","typeVersion":1,"position":[-1312,-736],"id":"c2a64a83-85db-42c3-848f-120879b393da","name":"DeepSeek Chat Model1","credentials":{"deepSeekApi":{"id":"XQXgm6mCKAHVpU2G","name":"DeepSeek account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatDeepSeek","typeVersion":1,"position":[-2480,-704],"id":"dcf093ea-1a7c-49b4-8a9f-189bc2efe862","name":"DeepSeek Chat Model","credentials":{"deepSeekApi":{"id":"XQXgm6mCKAHVpU2G","name":"DeepSeek account"}}},{"parameters":{"content":"üéõÔ∏è **CENTRALIZOVAN√Å KONFIGURACE**\n\n**JEDIN√ù ZDROJ PRAVDY:**\n‚úÖ Master Configuration node obsahuje V≈†E\n‚úÖ ≈Ω√°dn√© duplicitn√≠ nastaven√≠\n‚úÖ Snadn√° √∫dr≈æba a zmƒõny\n\n**CO OBSAHUJE:**\n‚Ä¢ Workflow nastaven√≠ (test_mode, batch_size, wait_time)\n‚Ä¢ Kontaktn√≠ √∫daje (email, telefon, jm√©no)\n‚Ä¢ Service type a rating threshold\n\n**CO Z≈ÆST√ÅV√Å V NODES:**\n‚Ä¢ Google Sheets ID - v Read/Update nodes\n‚Ä¢ Gmail credentials - v Send Email node\n‚Ä¢ Sheets credentials - v Google Sheets nodes\n\n**V√ùHODY:**\n‚Ä¢ Jedno m√≠sto pro business logic\n‚Ä¢ Credentials na spr√°vn√Ωch m√≠stech\n‚Ä¢ Snadn√© p≈ôep√≠n√°n√≠ mezi test/produkce\n‚Ä¢ ≈Ω√°dn√© zapomenut√© nastaven√≠\n\n**P≈ò√çKLAD ZMƒöNY:**\nChce≈° zmƒõnit email? ‚Üí Uprav Master Configuration ‚Üí Hotovo!","height":360,"width":350},"id":"dd7d0533-b0d0-432c-8e3e-7355a9de8abb","name":"üéõÔ∏è Centralized Config","type":"n8n-nodes-base.stickyNote","position":[-3088,352],"typeVersion":1},{"parameters":{"content":"üéØ **CENTRALIZOVAN√â KONTAKTN√ç √öDAJE**\n\n**JEDIN√ù ZDROJ PRAVDY:**\n‚úÖ Company Setup node obsahuje v≈°echny kontaktn√≠ √∫daje\n‚úÖ Gmail node automaticky pou≈æ√≠v√° tyto √∫daje\n‚úÖ ≈Ω√°dn√© duplicitn√≠ nastaven√≠\n\n**CO SE POU≈Ω√çV√Å:**\n‚Ä¢ sender_name: 'Andreas Brudovsk√Ω'\n‚Ä¢ email_address: 'andrasbrudovskyy@gmail.com'\n‚Ä¢ phone_number: '+420 735 913 637'\n‚Ä¢ company_name: 'Andreas Brudovsk√Ω'\n\n**V√ùHODY:**\n‚Ä¢ Jedno m√≠sto pro zmƒõny\n‚Ä¢ Konzistentn√≠ √∫daje\n‚Ä¢ Snadn√° √∫dr≈æba\n‚Ä¢ ≈Ω√°dn√© konflikty","height":280,"width":350},"id":"78040113-fdd7-47dd-ac45-fcb97ca76ee6","name":"üéØ Centralized Contacts","type":"n8n-nodes-base.stickyNote","position":[-3088,144],"typeVersion":1},{"parameters":{"content":"üìß **EMAIL STATUS FILTER**\n\n**Nov√Ω filtr:** Filter Not Sent Emails\n\n**Funkce:**\n‚Ä¢ Kontroluje sloupec 'Status' v Google Sheets\n‚Ä¢ P≈ôeskoƒç√≠ firmy s Status = 'sent'\n‚Ä¢ Zpracuje pouze nov√©/neodeslan√© emaily\n\n**V√Ωhody:**\n‚Ä¢ ≈Ω√°dn√© duplik√°tn√≠ emaily\n‚Ä¢ Bezpeƒçn√© opakovan√© spou≈°tƒõn√≠\n‚Ä¢ Sledov√°n√≠ pokroku\n\n**Status hodnoty:**\n‚Ä¢ 'sent' = email ji≈æ odesl√°n\n‚Ä¢ pr√°zdn√©/null = email je≈°tƒõ neodesl√°n","height":240,"width":350},"id":"019d458a-250d-4478-bf08-7961ac143215","name":"üìß Email Status Filter","type":"n8n-nodes-base.stickyNote","position":[-3936,-1360],"typeVersion":1},{"parameters":{"content":"üîß **DUPLIK√ÅTN√ç EMAILY - OPRAVENO**\n\n**Probl√©m vy≈ôe≈°en:**\n‚úÖ Company Setup ‚Üí Code node s runOnceForEachItem\n‚úÖ Generate Email pou≈æ√≠v√° .item.json\n‚úÖ Parse AI Response spr√°vn√° data\n\n**V√Ωsledek:**\n‚Ä¢ ≈Ω√°dn√© duplik√°tn√≠ emaily\n‚Ä¢ Ka≈æd√° firma dostane unik√°tn√≠ email\n‚Ä¢ Spr√°vn√© business data pro ka≈ædou firmu","height":200,"width":350},"id":"53a92b08-0789-4e9c-85e8-a0d7f47afb2f","name":"üîß Fixed Duplicates","type":"n8n-nodes-base.stickyNote","position":[-3072,-1376],"typeVersion":1},{"parameters":{"content":"‚ö° **INTELLIGENT CHUNKING**\n\n**Probl√©m vy≈ôe≈°en:**\n‚úÖ AI token limits - max 15 firem na call\n‚úÖ Rate limiting - inteligentn√≠ d√°vkov√°n√≠\n‚úÖ API n√°klady - optimalizovan√© batch size\n\n**Jak to funguje:**\n‚Ä¢ Chunk Businesses (15 per batch)\n‚Ä¢ Batch AI Business Rating\n‚Ä¢ Parse Batch AI Ratings\n‚Ä¢ Loop zpƒõt pro dal≈°√≠ chunk\n\n**V√Ωhody:**\n‚Ä¢ ≈Ω√°dn√© AI token limit chyby\n‚Ä¢ Optimalizovan√© API calls\n‚Ä¢ Spolehliv√© zpracov√°n√≠ stovek firem","height":280,"width":350},"id":"fb02a203-aa79-4ac9-9ba4-3cd10088f76e","name":"‚ö° Intelligent Chunking","type":"n8n-nodes-base.stickyNote","position":[-2640,-1808],"typeVersion":1},{"parameters":{"jsonSchemaExample":"{\n  \"ratings\": [\n    {\n      \"business_name\": \"Autoservis Praha\",\n      \"rating\": 4,\n      \"reasoning\": \"Lok√°ln√≠ autoservis pouze se z√°kladn√≠ Facebook str√°nkou - vysok√Ω potenci√°l pro profesion√°ln√≠ slu≈æby\",\n      \"marketing_potential\": \"high\",\n      \"recommended_services\": [\"profesion√°ln√≠ slu≈æby\", \"konzultace\", \"implementace\"],\n      \"industry_insights\": \"Automobilov√Ω pr≈Ømysl v ƒåR roste, online p≈ô√≠tomnost je kl√≠ƒçov√° pro z√≠sk√°n√≠ z√°kazn√≠k≈Ø\",\n      \"competitive_advantage\": \"Online objedn√°vky, fotogalerie prac√≠, recenze z√°kazn√≠k≈Ø\"\n    },\n    {\n      \"business_name\": \"Restaurace U Zlat√© rybky\",\n      \"rating\": 3,\n      \"reasoning\": \"Restaurace s nƒõjak√Ωmi slu≈æbami, ale s prostorem pro zlep≈°en√≠\",\n      \"marketing_potential\": \"medium\",\n      \"recommended_services\": [\"optimalizace\", \"vylep≈°en√≠\"],\n      \"industry_insights\": \"Gastronomick√Ω sektor v ƒåR je konkurenƒçn√≠, online objedn√°vky jsou standardem\",\n      \"competitive_advantage\": \"Online menu, rezervace stol≈Ø, doruƒçov√°n√≠\"\n    }\n  ]\n}"},"type":"@n8n/n8n-nodes-langchain.outputParserStructured","typeVersion":1.3,"position":[-2192,-736],"id":"b49fc789-6e56-45c2-bf6a-1e797e2e8b87","name":"Structured Output Parser1"},{"parameters":{"jsCode":"// Generate summary report of the email campaign\nconst allItems = $input.all();\n\nlet totalProcessed = 0;\nlet totalEmailsSent = 0;\nlet highPriorityCount = 0;\nlet mediumPriorityCount = 0;\nlet lowPriorityCount = 0;\nlet errors = [];\n\nfor (const item of allItems) {\n  totalProcessed++;\n  \n  if (item.json.success) {\n    totalEmailsSent++;\n    \n    switch(item.json.priority) {\n      case 'high':\n        highPriorityCount++;\n        break;\n      case 'medium':\n        mediumPriorityCount++;\n        break;\n      case 'low':\n        lowPriorityCount++;\n        break;\n    }\n  } else {\n    errors.push(item.json.error || 'Unknown error');\n  }\n}\n\nconst report = {\n  timestamp: new Date().toISOString(),\n  total_processed: totalProcessed,\n  emails_sent: totalEmailsSent,\n  success_rate: totalProcessed > 0 ? ((totalEmailsSent / totalProcessed) * 100).toFixed(2) + '%' : '0%',\n  priority_breakdown: {\n    high: highPriorityCount,\n    medium: mediumPriorityCount,\n    low: lowPriorityCount\n  },\n  errors: errors,\n  test_mode: $('Master Configuration').first().json.test_mode\n};\n\nreturn report;"},"id":"ead8ffb0-fb83-480b-b9b3-e658c8801ef8","name":"Generate Summary Report","type":"n8n-nodes-base.code","position":[-1392,-1168],"typeVersion":2},{"parameters":{"amount":"={{ $('Master Configuration').first().json.wait_time }}","unit":"seconds"},"id":"20e93929-9eef-4392-90db-b4f9b65dddca","name":"Wait Between Emails","type":"n8n-nodes-base.wait","position":[-80,-976],"typeVersion":1,"webhookId":"caa4c0a7-1ddc-4dbb-8de0-16d3925441bd"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"skip-check","operator":{"type":"boolean","operation":"notEquals"},"leftValue":"={{ $json.skip }}","rightValue":true}],"combinator":"and"},"options":{}},"id":"b387a7b8-e6cb-47aa-a133-b765aff53b82","name":"Filter Valid Emails","type":"n8n-nodes-base.filter","position":[-688,-976],"typeVersion":2.2},{"parameters":{"sendTo":"={{ $json.to }}","subject":"={{ $json.subject }}","emailType":"text","message":"={{ $json.body }}","options":{"appendAttribution":false,"senderName":"={{ $('Master Configuration').first().json.sender_name }}","replyTo":"={{ $('Master Configuration').first().json.email_address }}"}},"id":"6647507d-1bc6-4856-98df-277e3fb8e521","name":"Send Email","type":"n8n-nodes-base.gmail","position":[-496,-976],"typeVersion":2.1,"webhookId":"763bbad5-2836-4875-ae49-d372af3bb720","credentials":{"gmailOAuth2":{"id":"3M0CLo4vVbFsJnGB","name":"andreasbrudovskyy@gmail acc"}}},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Parse AI response and prepare for email sending\nconst aiResponse = $input.item.json.output;\nconst businessData = $('Prepare AI Data').item.json.business_data;\nconst testMode = $('Master Configuration').first().json.test_mode;\nconst testEmail = $('Master Configuration').first().json.test_email;\n\n// Determine recipient email\nlet recipientEmail = businessData.email;\nlet subjectPrefix = '';\n\nif (testMode) {\n  recipientEmail = testEmail;\n  subjectPrefix = '[TEST] ';\n}\n\n// Handle invalid email addresses gracefully\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\nif (!recipientEmail || recipientEmail === '' || recipientEmail === 'N/A' || !emailRegex.test(recipientEmail)) {\n  // Skip this business instead of throwing error\n  return {\n    skip: true,\n    reason: `Skipping ${businessData.company_name} - invalid email: ${recipientEmail}`,\n    business_data: businessData\n  };\n}\n\n// Additional validation for production mode\nif (!testMode) {\n  // Skip common invalid emails\n  const invalidEmails = ['info@', 'admin@', 'noreply@', 'test@', 'example@'];\n  const isInvalid = invalidEmails.some(invalid => recipientEmail.toLowerCase().includes(invalid));\n  \n  if (isInvalid) {\n    return {\n      skip: true,\n      reason: `Skipping ${businessData.company_name} - generic email: ${recipientEmail}`,\n      business_data: businessData\n    };\n  }\n}\n\nreturn {\n  to: recipientEmail,\n  subject: subjectPrefix + (aiResponse.subject || 'Profesion√°ln√≠ webov√© str√°nky'),\n  body: aiResponse.body || 'Email body not generated properly',\n  priority: aiResponse.priority || 'medium',\n  business_data: businessData,\n  test_mode: testMode,\n  skip: false\n};"},"id":"8251e08f-a5e5-4929-9aea-6e154a97fc12","name":"Parse AI Response","type":"n8n-nodes-base.code","position":[-848,-976],"typeVersion":2},{"parameters":{"jsonSchemaExample":"{\n  \"subject\": \"Profesion√°ln√≠ webov√© str√°nky pro va≈°i spoleƒçnost\",\n  \"body\": \"V√°≈æen√Ω pane/pan√≠,\\n\\nV≈°iml/a jsem si, ≈æe va≈°e spoleƒçnost...\",\n  \"priority\": \"high\"\n}"},"id":"9aa2950c-29fa-45fe-9b58-1ffefeaf8775","name":"Structured Output Parser","type":"@n8n/n8n-nodes-langchain.outputParserStructured","position":[-1040,-704],"typeVersion":1.2},{"parameters":{"promptType":"define","text":"=## BUSINESS DATA\n{{ $('Prepare AI Data').item.json.business_data.toJsonString() }}\n\n## YOUR COMPANY INFO\n{{ $('Master Configuration').first().json.toJsonString() }}\n\n## SERVICE FOCUS\n{{ $('Prepare AI Data').item.json.service_focus }}\n\n## RATING & PRIORITY\nRating: {{ $('Prepare AI Data').item.json.business_data.rating }}/5\nPriority: {{ $('Prepare AI Data').item.json.urgency_level }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"=## ROLE\nJsi expertn√≠ marketingov√Ω specialista pro {{ $('Master Configuration').first().json.service_type }} slu≈æby v ƒåesk√© republice. Tv√Ωm √∫kolem je vytvo≈ôit personalizovan√Ω cold email v ƒçe≈°tinƒõ.\n\n## D≈ÆLE≈ΩIT√â PRAVIDLA\n\n**1. KONTAKTN√ç √öDAJE - KRITICK√â:**\n- V emailu MUS√ç≈† pou≈æ√≠t KONTAKTN√ç √öDAJE ODES√çLATELE ({{ $('Master Configuration').first().json.sender_name }}, {{ $('Master Configuration').first().json.email_address }}, {{ $('Master Configuration').first().json.phone_number }})\n- NIKDY nepou≈æ√≠vej kontaktn√≠ √∫daje p≈ô√≠jemce v podpisu ani se za nƒõ neprezentuj!\n- Podpis mus√≠ obsahovat: {{ $('Master Configuration').first().json.sender_name }}, {{ $('Master Configuration').first().json.email_address }}, {{ $('Master Configuration').first().json.phone_number }}\n- P≈ôedmƒõt ponechej jednoduch√Ω, tedy jenom jak√° slu≈æba je propagov√°na\n\n**2. PERSONALIZACE:**\n- Pou≈æij obor: {{ $('Prepare AI Data').item.json.business_data.industry }}\n\n- D√°le vzka≈æ ≈æe nap≈ô√≠klad u webdesignu, by byla nab√≠dka takov√°, ≈æe se by se firmƒõ prvnƒõ uk√°zal zadarmo n√°vrh webov√Ωch str√°nek, a pokud by to bylo schv√°leno tak bychom se domluvili na cenƒõ\n\n**4. STRUKTURA EMAILU:**\n1. Osloven√≠ (V√°≈æen√Ω pane/pan√≠)\n2. Personalizovan√Ω √∫vod\n3. Probl√©m (co jim chyb√≠)\n4. ≈òe≈°en√≠ (jak jim pom≈Ø≈æeme) + jemn√© zm√≠nky o v√Ωhod√°ch\n5. D√°le vzka≈æ ≈æe nap≈ô√≠klad u webdesignu, by byla nab√≠dka takov√°, ≈æe se by se firmƒõ prvnƒõ uk√°zal zadarmo n√°vrh webov√Ωch str√°nek, a pokud by to bylo schv√°leno tak bychom se domluvili na cenƒõ\n6. Call to action (konkr√©tn√≠ dal≈°√≠ krok)\n7. Podpis (profesion√°ln√≠ form√°t s firmou)\n-tohle v≈°e zanechej jednoduch√©, a≈• to nep≈Øsob√≠ jako spam mail\n\n\n**5. RATING-BASED P≈ò√çSTUP:**\n- Rating 4-5: \"Vytvo≈ô√≠me profesion√°ln√≠ {{ $('Master Configuration').first().json.service_type }} ≈ôe≈°en√≠ od z√°klad≈Ø\"\n- Rating 3: \"Vylep≈°√≠me va≈°e souƒçasn√© {{ $('Master Configuration').first().json.service_type }} mo≈ænosti\"\n- Rating 1-2: \"Konzultace a anal√Ωza {{ $('Master Configuration').first().json.service_type }} mo≈ænost√≠\"\n- Rating NEZMI≈áUJ ve fin√°ln√≠m mailu!\n\n**6. DYNAMICK√â CALL TO ACTION:**\n- Vygeneruj 1-2 relevantn√≠ call to action pro {{ $('Master Configuration').first().json.service_type }}\n- Pou≈æij konkr√©tn√≠ akce: online sch≈Øzka, nab√≠dka, konzultace, demo\n- P≈ôizp≈Øsob oboru firmy: {{ $('Prepare AI Data').item.json.business_data.industry }}\n- Pou≈æij telefon: {{ $('Master Configuration').first().json.phone_number }}\n\n## OUTPUT FORMAT\nVr√°≈• JSON objekt:\n{\n  \"subject\": \"[P≈ôedmƒõt emailu]\",\n  \"body\": \"[Tƒõlo emailu v ƒçe≈°tinƒõ s tv√Ωmi kontaktn√≠mi √∫daji]\",\n  \"priority\": \"high/medium/low\"\n}\n\n## PROFESION√ÅLN√ç PODPIS\nPou≈æij tento form√°t:\n\nS pozdravem,\n{{ $('Master Configuration').first().json.sender_name }}\n{{ $('Master Configuration').first().json.email_address }}\n{{ $('Master Configuration').first().json.phone_number }}\n\nVytvo≈ô personalizovan√Ω email pro firmu {{ $('Prepare AI Data').item.json.business_data.company_name }}."}]},"batching":{}},"id":"18782efe-8e0a-49ca-8584-dc8e00f6cc96","name":"Generate Personalized Email","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[-1280,-976],"typeVersion":1.7},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Prepare data for AI email generation\nconst business = $input.item.json;\n\n// Handle both Google Sheets format and AI rating format\nconst businessData = {\n  company_name: business['Business Name'] || business.business_name || 'Unknown Company',\n  contact_person: business.Contact_Person || business.Owner || 'Business Owner',\n  email: business.Email || business.email || '',\n  phone: business.Phone || business.phone || '',\n  website: business.Website || business.website || '',\n  address: business['Full Address'] || business.address || '',\n  city: business.City || business.city || '',\n  industry: business.Industry || business.industry || '',\n  rating: business.rating || 0,\n  reasoning: business.reasoning || '',\n  marketing_potential: business.marketing_potential || 'medium',\n  recommended_services: business.recommended_services || [],\n  industry_insights: business.industry_insights || '',\n  competitive_advantage: business.competitive_advantage || '',\n  template_type: business.email_template || 'medium_priority'\n};\n\n// Create personalized prompt based on rating\nlet serviceFocus = '';\nlet urgencyLevel = '';\n\nif (businessData.rating >= 4) {\n  serviceFocus = 'professional website development';\n  urgencyLevel = 'high priority';\n} else if (businessData.rating >= 3) {\n  serviceFocus = 'website upgrade and optimization';\n  urgencyLevel = 'medium priority';\n} else {\n  serviceFocus = 'website consultation and improvement';\n  urgencyLevel = 'low priority';\n}\n\nreturn {\n  business_data: businessData,\n  service_focus: serviceFocus,\n  urgency_level: urgencyLevel,\n  template_type: businessData.template_type\n};"},"id":"3e789d09-0c4c-46da-a199-9b2343d54567","name":"Prepare AI Data","type":"n8n-nodes-base.code","position":[-1456,-976],"typeVersion":2},{"parameters":{"batchSize":"={{ $('Master Configuration').first().json.batch_size }}","options":{}},"id":"3a0a652a-ac32-4f3d-a2b1-7d34f788865b","name":"Batch Process","type":"n8n-nodes-base.splitInBatches","position":[-1712,-1008],"typeVersion":3},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"rating-check","operator":{"type":"number","operation":"gte"},"leftValue":"={{ $json.rating }}","rightValue":"={{ $('Master Configuration').first().json.rating_threshold }}"}],"combinator":"and"},"options":{}},"id":"63e8f4a0-193f-4790-b2a9-ab523b6d8c55","name":"Filter High Priority (Rating 3-5)","type":"n8n-nodes-base.filter","position":[-1936,-1024],"typeVersion":2.2},{"parameters":{"jsCode":"// Parse batch AI ratings and return individual business items with ratings\nconst aiResponse = $input.item.json.output;\nconst batchRatings = aiResponse.ratings || [];\nconst allItems = $('Prepare Chunk for AI Rating').all();\n\n// Get the original businesses from the chunk\nconst originalBusinesses = allItems[0].json.businesses;\n\n// Create enriched business items with ratings\nconst enrichedItems = originalBusinesses.map(business => {\n  const businessName = business.business_name || '';\n  \n  // Find matching rating for this business\n  const rating = batchRatings.find(r => r.business_name === businessName);\n  \n  if (!rating) {\n    // Fallback if business not found in ratings\n    return {\n      ...business,\n      rating: 0,\n      reasoning: 'Business not found in AI ratings',\n      marketing_potential: 'low',\n      recommended_services: [],\n      industry_insights: '',\n      competitive_advantage: '',\n      email_template: 'low_priority',\n      ai_rated: true\n    };\n  }\n  \n  // Determine email template based on rating\n  let emailTemplate = 'low_priority';\n  if (rating.rating >= 4) {\n    emailTemplate = 'high_priority';\n  } else if (rating.rating >= 2) {\n    emailTemplate = 'medium_priority';\n  }\n  \n  // Combine business data with AI rating (simplified format)\n  const enrichedData = {\n    ...business,\n    rating: rating.rating,\n    reasoning: rating.reasoning || 'Hodnocen√≠ bez vysvƒõtlen√≠',\n    marketing_potential: rating.marketing_potential || 'medium',\n    recommended_services: rating.recommended_services || [],\n    industry_insights: rating.industry_insights || '',\n    competitive_advantage: rating.competitive_advantage || '',\n    email_template: emailTemplate,\n    ai_rated: true\n  };\n  \n  return enrichedData;\n});\n\nreturn enrichedItems;"},"id":"07a65460-c045-4ada-b5d7-b41306c43b74","name":"Parse Batch AI Ratings","type":"n8n-nodes-base.code","position":[-2112,-928],"typeVersion":2},{"parameters":{"promptType":"define","text":"=Businesses Data:\n{{ $('Prepare Chunk for AI Rating').first().json.businesses.toJsonString() }}\n\nService Type: {{ $('Prepare Chunk for AI Rating').first().json.service_type }}","hasOutputParser":true,"messages":{"messageValues":[{"message":"=Jsi AI marketing specialista pro {{ $('Prepare Chunk for AI Rating').first().json.service_type }} slu≈æby v ƒåR. Ohodno≈• ka≈ædou firmu 0-5 podle potenci√°lu pro {{ $('Prepare Chunk for AI Rating').first().json.service_type }}.\n\n**KRIT√âRIA:**\n5: ≈Ω√°dn√© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - vysok√Ω potenci√°l\n4: Z√°kladn√≠ {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - pot≈ôebuje vylep≈°en√≠\n3: Nƒõjak√© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - prostor pro optimalizaci\n2: Dobr√© {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - omezen√Ω potenci√°l\n1: Vynikaj√≠c√≠ {{ $('Prepare Chunk for AI Rating').first().json.service_type }} - minim√°ln√≠ potenci√°l\n0: Nevhodn√© (velk√© firmy, st√°tn√≠ instituce)\n\n**RYCHL√â ANAL√ùZY:**\n- Bez webu/webnode/facebook reprezentace webu = Rating 4-5\n- Z√°kladn√≠ web = Rating 3\n- Pokroƒçil√Ω web = Rating 1-2\n- Mal√© firmy (1-10 zamƒõstnanc≈Ø) = +1 rating\n- Velk√© firmy (50+) = -1 rating\n\n**OUTPUT:** JSON s ratings array:\n{\n  \"ratings\": [\n    {\n      \"business_name\": \"N√°zev firmy\",\n      \"rating\": 4,\n      \"reasoning\": \"Kr√°tk√© vysvƒõtlen√≠ v ƒçe≈°tinƒõ\",\n      \"marketing_potential\": \"high/medium/low\"\n    }\n  ]\n}\n\nAnalyzuj v≈°echny firmy a vra≈• hodnocen√≠."}]},"batching":{}},"id":"89472445-8330-4699-b7ea-1f834b3d2a49","name":"Batch AI Business Rating","type":"@n8n/n8n-nodes-langchain.chainLlm","position":[-2416,-928],"typeVersion":1.7,"retryOnFail":true},{"parameters":{"jsCode":"// Prepare chunk of businesses for AI rating\nconst allItems = $input.all();\nconst serviceType = allItems[0].json.service_type;\n\n// Extract businesses from this chunk\nconst businesses = allItems.map(item => {\n  const business = item.json;\n  return {\n    business_name: business.business_name || '',\n    description: business.description || '',\n    website: business.website || '',\n    all_websites: business.all_websites || '',\n    industry: business.industry || '',\n    city: business.city || '',\n    address: business.address || '',\n    phone: business.phone || '',\n    email: business.email || '',\n    facebook: business.facebook || '',\n    instagram: business.instagram || '',\n    linkedin: business.linkedin || '',\n    twitter: business.twitter || '',\n    youtube: business.youtube || '',\n    opening_hours: business.opening_hours || '',\n    ico: business.ico || ''\n  };\n});\n\nreturn {\n  businesses: businesses,\n  service_type: serviceType,\n  chunk_size: businesses.length,\n  chunk_number: $('Chunk Businesses (15 per batch)').context.currentBatchIndex + 1\n};"},"id":"e3bdcde8-e4cc-4225-b5af-18d4d2e1893d","name":"Prepare Chunk for AI Rating","type":"n8n-nodes-base.code","position":[-2576,-928],"typeVersion":2},{"parameters":{"batchSize":15,"options":{}},"id":"c66a6955-9e84-41f5-ae6e-a85cf4797cf1","name":"Chunk Businesses (15 per batch)","type":"n8n-nodes-base.splitInBatches","position":[-2832,-960],"typeVersion":3},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Prepare individual business for processing\nconst business = $input.item.json;\nconst serviceType = $('Master Configuration').first().json.service_type;\n\n// Prepare business data\nreturn {\n  business_name: business['Business Name'] || '',\n  description: business.Description || '',\n  website: business.Website || '',\n  all_websites: business['All Websites'] || '',\n  industry: business.Industry || '',\n  city: business.City || '',\n  address: business['Full Address'] || '',\n  phone: business.Phone || '',\n  email: business.Email || '',\n  facebook: business.Facebook || '',\n  instagram: business.Instagram || '',\n  linkedin: business.LinkedIn || '',\n  twitter: business.Twitter || '',\n  youtube: business.YouTube || '',\n  opening_hours: business['Opening Hours'] || '',\n  ico: business.ICO || '',\n  // Keep original data for later use\n  original_data: business,\n  service_type: serviceType\n};"},"id":"137bf5d0-c9d0-4d15-88f5-027333765167","name":"Batch Prepare Business Data","type":"n8n-nodes-base.code","position":[-3040,-960],"typeVersion":2},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"email-check","operator":{"type":"string","operation":"exists"},"leftValue":"={{ $json.Email }}","rightValue":""},{"id":"business-name-check","operator":{"type":"string","operation":"exists"},"leftValue":"={{ $json['Business Name'] }}","rightValue":""},{"id":"6d9919c9-38b9-47dc-b98b-7221fabf82c6","leftValue":"={{ $json.Status }}","rightValue":"sent","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"id":"5a7556a0-0abf-4274-a79f-f29c926a419c","name":"Filter Valid Businesses","type":"n8n-nodes-base.filter","position":[-3232,-960],"typeVersion":2.2},{"parameters":{"documentId":{"__rl":true,"value":"1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs","mode":"list","cachedResultName":"n8n firmyCZ scrape","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"List 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs/edit#gid=0"},"options":{}},"id":"f823f01b-345c-4fad-ac33-740c31467157","name":"Read Google Sheet","type":"n8n-nodes-base.googleSheets","position":[-3424,-960],"typeVersion":4.6,"credentials":{"googleSheetsOAuth2Api":{"id":"3ckXjDbOIbpiK9so","name":"andreasbrudovskyy gmail"}}},{"parameters":{"assignments":{"assignments":[{"id":"service-type","name":"service_type","type":"string","value":"webdesign"},{"id":"test-mode","name":"test_mode","type":"boolean","value":false},{"id":"test-email","name":"test_email","type":"string","value":"andreas.ab@seznam.cz"},{"id":"batch-size","name":"batch_size","type":"number","value":5},{"id":"wait-time","name":"wait_time","type":"number","value":5},{"id":"rating-threshold","name":"rating_threshold","type":"number","value":4},{"id":"company-name","name":"company_name","type":"string","value":"rec solutions"},{"id":"email-address","name":"email_address","type":"string","value":"andrasbrudovskyy@gmail.com"},{"id":"phone-number","name":"phone_number","type":"string","value":"+420 735 913 637"},{"id":"sender-name","name":"sender_name","type":"string","value":"Andreas Brudovsk√Ω"}]},"options":{}},"id":"bca2d5c4-3225-4fe2-a238-a7c3fe8648db","name":"Master Configuration","type":"n8n-nodes-base.set","position":[-3616,-960],"typeVersion":3.4},{"parameters":{},"id":"8cc6a070-986f-4dc6-a7eb-bc1c17eb525a","name":"Manual Trigger","type":"n8n-nodes-base.manualTrigger","position":[-3840,-960],"typeVersion":1},{"parameters":{"content":"üö® **PRODUKƒåN√ç KONTROLN√ç SEZNAM**\n\n**P≈òED P≈òEPNUT√çM NA PRODUKCI:**\n\n1. ‚úÖ **Kontaktn√≠ √∫daje**\n   ‚Ä¢ Zkontroluj Company Setup node\n   ‚Ä¢ Skuteƒçn√Ω n√°zev firmy\n   ‚Ä¢ Skuteƒçn√Ω email a telefon\n   ‚Ä¢ Skuteƒçn√© jm√©no odes√≠latele\n\n2. ‚úÖ **Test re≈æim**\n   ‚Ä¢ Service Configuration: test_mode = false\n   ‚Ä¢ Otestuj s mal√Ωm poƒçtem firem\n   ‚Ä¢ Zkontroluj prvn√≠ emaily\n\n3. ‚úÖ **API limity**\n   ‚Ä¢ Gmail: max 500 email≈Ø/den\n   ‚Ä¢ OpenAI: dostatek kreditu\n   ‚Ä¢ Google Sheets: opr√°vnƒõn√≠\n\n4. ‚úÖ **Bezpeƒçnost**\n   ‚Ä¢ ≈Ω√°dn√© placeholder √∫daje\n   ‚Ä¢ Validace email≈Ø aktivn√≠\n   ‚Ä¢ Rate limiting nastaven\n\n**‚ö†Ô∏è VAROV√ÅN√ç:**\n‚Ä¢ Emaily se ode≈°lou na skuteƒçn√© adresy\n‚Ä¢ Nelze vr√°tit zpƒõt\n‚Ä¢ Sleduj bounce rate","height":400,"width":400},"id":"f0b3f784-30d4-4e09-bc9d-dd33af67eddd","name":"üö® Production Checklist","type":"n8n-nodes-base.stickyNote","position":[-3936,144],"typeVersion":1},{"parameters":{"content":"üéØ **CUSTOMIZATION**\n\n**AI Prompts:**\n‚Ä¢ AI Business Rating - krit√©ria hodnocen√≠\n‚Ä¢ Generate Email - styl email≈Ø\n‚Ä¢ Rating threshold - minim√°ln√≠ rating\n\n**Email Templates:**\n‚Ä¢ ≈†ablony podle ratingu\n‚Ä¢ Company Setup √∫daje\n‚Ä¢ Personalizace promƒõnn√Ωch\n\n**Business Logic:**\n‚Ä¢ Rating criteria\n‚Ä¢ Filtrov√°n√≠\n‚Ä¢ Dal≈°√≠ slu≈æby\n\n**Safety:**\n‚Ä¢ V≈ædy testuj s test_mode=true\n‚Ä¢ Sleduj API limity","height":300,"width":320},"id":"c79f6ac2-593b-431a-9c4c-8069c2fd9e01","name":"üéØ Customization","type":"n8n-nodes-base.stickyNote","position":[-3280,0],"typeVersion":1},{"parameters":{"content":"üìä **PERFORMANCE**\n\n**Optimalizace:**\n‚Ä¢ Batch size: 5-10 firem\n‚Ä¢ Wait time: 30s mezi emaily\n‚Ä¢ ~100-200 firem za hodinu\n\n**Limity:**\n‚Ä¢ Gmail: 500 email≈Ø/den\n‚Ä¢ OpenAI: z√°le≈æ√≠ na kreditu\n‚Ä¢ Google Sheets: 100 requests/100s\n\n**Monitoring:**\n‚Ä¢ Sleduj OpenAI API kredit\n‚Ä¢ Kontroluj bounce rate\n‚Ä¢ Z√°lohuj data pravidelnƒõ","height":280,"width":300},"id":"db9432fe-f710-40b0-b856-cd304b184c6d","name":"üìä Performance","type":"n8n-nodes-base.stickyNote","position":[-2400,-496],"typeVersion":1},{"parameters":{"content":"üîß **TROUBLESHOOTING**\n\n**Emaily se neodes√≠laj√≠:**\n‚Ä¢ Zkontroluj Gmail credentials\n‚Ä¢ Ovƒõ≈ô nastaven√≠ odes√≠latele\n\n**AI nefunguje:**\n‚Ä¢ Zkontroluj OpenAI API credentials\n‚Ä¢ Ovƒõ≈ô API kredit\n\n**Google Sheets se neaktualizuje:**\n‚Ä¢ Zkontroluj Google Sheets credentials\n‚Ä¢ Ovƒõ≈ô opr√°vnƒõn√≠ k tabulce\n\n**Workflow se zastav√≠:**\n‚Ä¢ Zkontroluj, ≈æe Code nodes maj√≠:\n  mode: 'runOnceForEachItem'","height":320,"width":320},"id":"9aad1947-81b8-429e-acee-e5baeb49df86","name":"üîß Troubleshooting","type":"n8n-nodes-base.stickyNote","position":[-2800,-496],"typeVersion":1},{"parameters":{"content":"üîÑ **WORKFLOW FLOW**\n\n**1. Spu≈°tƒõn√≠** ‚Üí Manual Trigger\n**2. Konfigurace** ‚Üí Service Configuration\n**3. Data** ‚Üí Read Google Sheet\n**4. Filtrov√°n√≠** ‚Üí Filter Valid Businesses\n**5. AI Rating** ‚Üí Batch AI Business Rating\n**6. Priorita** ‚Üí Filter High Priority (3-5)\n**7. D√°vkov√°n√≠** ‚Üí Batch Process\n**8. Emaily** ‚Üí Generate ‚Üí Send ‚Üí Update\n**9. ƒåek√°n√≠** ‚Üí Wait Between Emails\n**10. Loop** ‚Üí Zpƒõt na dal≈°√≠ firmu","height":300,"width":350},"id":"749fe85e-0fbb-4a14-bdf5-44bfd21043ec","name":"üîÑ Workflow Flow","type":"n8n-nodes-base.stickyNote","position":[-3296,-480],"typeVersion":1},{"parameters":{"content":"üîë **CREDENTIALS**\n\n**Pot≈ôebn√© API kl√≠ƒçe:**\n‚Ä¢ Google Sheets OAuth2 - ƒçten√≠/aktualizace\n‚Ä¢ Gmail OAuth2 - odes√≠l√°n√≠ email≈Ø\n‚Ä¢ OpenAI API - AI hodnocen√≠ a generov√°n√≠\n\n**TEST MODE:**\n‚Ä¢ test_mode: true ‚Üí emaily na test_email\n‚Ä¢ test_mode: false ‚Üí emaily na skuteƒçn√© adresy\n\n**‚ö†Ô∏è D≈ÆLE≈ΩIT√â:**\n‚Ä¢ Zkontroluj OpenAI API kredit\n‚Ä¢ Ovƒõ≈ô opr√°vnƒõn√≠ k Google Sheets","height":280,"width":350},"id":"0c4b4f83-b3e4-4097-9400-79cdf6d41851","name":"üîë Credentials","type":"n8n-nodes-base.stickyNote","position":[-3920,-16],"typeVersion":1},{"parameters":{"content":"üöÄ **SMART MAIL AGENT**\n\n**√öƒåEL:** Automatick√© hodnocen√≠ firem a odes√≠l√°n√≠ personalizovan√Ωch email≈Ø\n\n**RYCHL√ù START:**\n1. ‚úÖ Zkontroluj credentials (Google Sheets, Gmail, OpenAI)\n2. ‚úÖ Nastav test_mode=true pro testov√°n√≠\n3. ‚úÖ Uprav Company Setup s tv√Ωmi √∫daji\n4. ‚úÖ Spus≈• workflow\n\n**KL√çƒåOV√Å NASTAVEN√ç:**\n‚Ä¢ test_mode: true/false\n‚Ä¢ batch_size: 5-10 firem\n‚Ä¢ wait_time: 30s mezi emaily\n‚Ä¢ rating_threshold: 3 (minim√°ln√≠ rating)\n\n**BEZPEƒåNOST:**\n‚ö†Ô∏è V≈ædy testuj p≈ôed produkƒçn√≠m spu≈°tƒõn√≠m\n‚ö†Ô∏è Sleduj OpenAI API kredit","height":320,"width":400},"id":"4c23118d-f4e4-4661-91cc-032b4bea0093","name":"üìã Quick Start Guide","type":"n8n-nodes-base.stickyNote","position":[-3936,-496],"typeVersion":1},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs","mode":"list","cachedResultName":"n8n firmyCZ scrape","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"List 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1e7PxPVzUyiWlvygeoTdenfq7vqDZqG2N2lH-G4F5ZSs/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"Business Name":"={{ $('Parse AI Response').item.json.business_data.company_name }}","Status":"sent"},"matchingColumns":["Business Name"],"schema":[{"id":"Business Name","displayName":"Business Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"Email","displayName":"Email","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Phone","displayName":"Phone","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Website","displayName":"Website","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Business URL","displayName":"Business URL","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Description","displayName":"Description","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Street","displayName":"Street","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"City","displayName":"City","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Postal Code","displayName":"Postal Code","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Full Address","displayName":"Full Address","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"ICO","displayName":"ICO","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Opening Hours","displayName":"Opening Hours","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"All Phones","displayName":"All Phones","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"All Websites","displayName":"All Websites","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Facebook","displayName":"Facebook","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Instagram","displayName":"Instagram","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"LinkedIn","displayName":"LinkedIn","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Twitter","displayName":"Twitter","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"YouTube","displayName":"YouTube","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Latitude","displayName":"Latitude","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Longitude","displayName":"Longitude","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Status","displayName":"Status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"id","displayName":"id","required":false,"defaultMatch":true,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"threadId","displayName":"threadId","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"labelIds","displayName":"labelIds","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"row_number","displayName":"row_number","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"readOnly":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"id":"2f3a713a-67a1-4e3b-bc4e-b1128d521688","name":"Update Google Sheet Status1","type":"n8n-nodes-base.googleSheets","position":[-288,-976],"typeVersion":4.6,"credentials":{"googleSheetsOAuth2Api":{"id":"3ckXjDbOIbpiK9so","name":"andreasbrudovskyy gmail"}}}],"connections":{"Wait Between Emails":{"main":[[{"node":"Batch Process","type":"main","index":0}]]},"Filter Valid Emails":{"main":[[{"node":"Send Email","type":"main","index":0}]]},"Send Email":{"main":[[{"node":"Update Google Sheet Status1","type":"main","index":0}]]},"Parse AI Response":{"main":[[{"node":"Filter Valid Emails","type":"main","index":0}]]},"DeepSeek Chat Model1":{"ai_languageModel":[[{"node":"Generate Personalized Email","type":"ai_languageModel","index":0}]]},"Structured Output Parser":{"ai_outputParser":[[{"node":"Generate Personalized Email","type":"ai_outputParser","index":0}]]},"Generate Personalized Email":{"main":[[{"node":"Parse AI Response","type":"main","index":0}]]},"Prepare AI Data":{"main":[[{"node":"Generate Personalized Email","type":"main","index":0}]]},"Batch Process":{"main":[[{"node":"Generate Summary Report","type":"main","index":0}],[{"node":"Prepare AI Data","type":"main","index":0}]]},"Filter High Priority (Rating 3-5)":{"main":[[{"node":"Batch Process","type":"main","index":0}]]},"Parse Batch AI Ratings":{"main":[[{"node":"Chunk Businesses (15 per batch)","type":"main","index":0}]]},"DeepSeek Chat Model":{"ai_languageModel":[[{"node":"Batch AI Business Rating","type":"ai_languageModel","index":0}]]},"Structured Output Parser1":{"ai_outputParser":[[{"node":"Batch AI Business Rating","type":"ai_outputParser","index":0}]]},"Batch AI Business Rating":{"main":[[{"node":"Parse Batch AI Ratings","type":"main","index":0}]]},"Prepare Chunk for AI Rating":{"main":[[{"node":"Batch AI Business Rating","type":"main","index":0}]]},"Chunk Businesses (15 per batch)":{"main":[[{"node":"Filter High Priority (Rating 3-5)","type":"main","index":0}],[{"node":"Prepare Chunk for AI Rating","type":"main","index":0}]]},"Batch Prepare Business Data":{"main":[[{"node":"Chunk Businesses (15 per batch)","type":"main","index":0}]]},"Filter Valid Businesses":{"main":[[{"node":"Batch Prepare Business Data","type":"main","index":0}]]},"Read Google Sheet":{"main":[[{"node":"Filter Valid Businesses","type":"main","index":0}]]},"Master Configuration":{"main":[[{"node":"Read Google Sheet","type":"main","index":0}]]},"Manual Trigger":{"main":[[{"node":"Master Configuration","type":"main","index":0}]]},"Update Google Sheet Status1":{"main":[[{"node":"Wait Between Emails","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"b78e9bb3-d16e-4345-b1d9-568c64538c77","triggerCount":0,"shared":[{"createdAt":"2025-08-13T10:07:02.294Z","updatedAt":"2025-08-13T10:07:02.294Z","role":"workflow:owner","workflowId":"1B7UywC4zR0yjdFp","projectId":"zpk8zHoHWXf3cQ7T"}],"tags":[]}